{
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "name": "@cocteau-twins-pc/rust-core",
  "projectType": "library",
  "sourceRoot": "libs/rust-core/src",
  "targets": {
    "build-napi": {
      "executor": "nx:run-commands",
      "inputs": ["rust", "{projectRoot}/Cargo.toml", "{projectRoot}/build.rs"],
      "outputs": ["{projectRoot}/*.node", "{projectRoot}/index.js", "{projectRoot}/index.d.ts"],
      "options": {
        "command": "napi build --platform --release",
        "cwd": "{projectRoot}"
      },
      "configurations": {
        "debug": {
          "command": "napi build --platform"
        }
      }
    },
    "build": {
      "executor": "nx:run-commands",
      "dependsOn": ["build-napi"],
      "inputs": [
        "{projectRoot}/index.js",
        "{projectRoot}/index.d.ts",
        "{projectRoot}/package.json"
      ],
      "outputs": ["{projectRoot}/dist"],
      "options": {
        "commands": [
          "mkdir -p dist",
          "cp index.js dist/",
          "cp index.d.ts dist/",
          "cp package.json dist/",
          "cp *.node dist/ 2>/dev/null || true"
        ],
        "cwd": "{projectRoot}",
        "parallel": false
      }
    },
    "test": {
      "executor": "nx:run-commands",
      "dependsOn": ["build-napi"],
      "inputs": [
        "{projectRoot}/__test__/**/*",
        "{projectRoot}/src/**/*.rs",
        "{projectRoot}/Cargo.toml"
      ],
      "options": {
        "command": "npm test",
        "cwd": "{projectRoot}"
      }
    },
    "lint": {
      "executor": "nx:run-commands",
      "inputs": ["{projectRoot}/src/**/*.rs", "{projectRoot}/Cargo.toml"],
      "options": {
        "commands": ["cargo fmt --check", "cargo clippy -- -D warnings"],
        "cwd": "{projectRoot}",
        "parallel": false
      }
    },
    "format": {
      "executor": "nx:run-commands",
      "inputs": ["{projectRoot}/src/**/*.rs", "{projectRoot}/**/*.toml"],
      "options": {
        "commands": ["cargo fmt"],
        "cwd": "{projectRoot}",
        "parallel": false
      }
    },
    "clean": {
      "executor": "nx:run-commands",
      "options": {
        "commands": ["cargo clean", "rm -rf dist", "rm -f *.node"],
        "cwd": "{projectRoot}",
        "parallel": false
      }
    }
  },
  "tags": ["type:library", "platform:rust", "scope:core"]
}
